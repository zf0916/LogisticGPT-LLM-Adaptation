{"query_id": "A1", "db_id": "t2sql", "nl_query": "On average, how many packages are picked up per day?", "gold_sql": "SELECT AVG(cnt)::float AS avg_pickups_per_day FROM ( SELECT DATE_TRUNC('day', p.timestamp_utc) AS day, COUNT(*) AS cnt FROM public.pickup p GROUP BY day ) d;"}
{"query_id": "A2", "db_id": "t2sql", "nl_query": "On which date was the highest number of deliveries completed?", "gold_sql": "SELECT day::date AS date, cnt FROM ( SELECT DATE_TRUNC('day', d.timestamp_utc) AS day, COUNT(*) AS cnt FROM public.delivery d GROUP BY day ) s ORDER BY cnt DESC, day ASC LIMIT 1;"}
{"query_id": "A3", "db_id": "t2sql", "nl_query": "During which hour of day do pickups peak?", "gold_sql": "SELECT EXTRACT(HOUR FROM p.timestamp_utc) AS hour_of_day, COUNT(*) AS cnt FROM public.pickup p GROUP BY hour_of_day ORDER BY cnt DESC, hour_of_day ASC LIMIT 1;"}
{"query_id": "A4", "db_id": "t2sql", "nl_query": "Which day of week has the fewest deliveries on average?", "gold_sql": "WITH daily AS ( SELECT DATE_TRUNC('day', d.timestamp_utc) AS day, EXTRACT(DOW FROM d.timestamp_utc) AS dow, COUNT(*) AS cnt FROM public.delivery d GROUP BY day, dow ) SELECT dow, AVG(cnt)::float AS avg_cnt FROM daily GROUP BY dow ORDER BY avg_cnt ASC, dow ASC LIMIT 1;"}
{"query_id": "A5", "db_id": "t2sql", "nl_query": "Over the dataset period, how many total deliveries were completed?", "gold_sql": "SELECT COUNT(*) AS total_deliveries FROM public.delivery d;"}
{"query_id": "B1", "db_id": "t2sql", "nl_query": "What is the average delivery time in each city?", "gold_sql": "SELECT d.city, AVG(EXTRACT(EPOCH FROM (d.timestamp_utc - d.accept_ts_utc)) / 3600.0) AS avg_hours FROM public.delivery d WHERE d.timestamp_utc >= d.accept_ts_utc GROUP BY d.city ORDER BY avg_hours ASC;"}
{"query_id": "B2", "db_id": "t2sql", "nl_query": "How many pickups occurred after their window time?", "gold_sql": "SELECT COUNT(*) AS late_pickups FROM public.pickup p WHERE p.time_window_end_utc IS NOT NULL AND p.timestamp_utc > p.time_window_end_utc;"}
{"query_id": "B3", "db_id": "t2sql", "nl_query": "Which city has the longest average pickup delay beyond the promised time window?", "gold_sql": "SELECT p.city, AVG(EXTRACT(EPOCH FROM (p.timestamp_utc - p.time_window_end_utc)) / 3600.0) AS avg_late_hours FROM public.pickup p WHERE p.time_window_end_utc IS NOT NULL AND p.timestamp_utc > p.time_window_end_utc GROUP BY p.city HAVING COUNT(*) >= 30 ORDER BY avg_late_hours DESC, p.city ASC LIMIT 1;"}
{"query_id": "B4", "db_id": "t2sql", "nl_query": "What is the longest observed delivery time for any package?", "gold_sql": "SELECT MAX(EXTRACT(EPOCH FROM (d.timestamp_utc - d.accept_ts_utc)) / 3600.0) AS max_delivery_hours FROM public.delivery d WHERE d.timestamp_utc >= d.accept_ts_utc;"}
{"query_id": "B5", "db_id": "t2sql", "nl_query": "How many deliveries took more than 2 hours from acceptance to completion?", "gold_sql": "SELECT COUNT(*) AS deliveries_over_2h FROM public.delivery d WHERE d.timestamp_utc >= d.accept_ts_utc AND EXTRACT(EPOCH FROM (d.timestamp_utc - d.accept_ts_utc)) / 3600.0 > 2;"}
{"query_id": "C1", "db_id": "t2sql", "nl_query": "Which courier delivered the most packages overall?", "gold_sql": "SELECT d.courier_id, COUNT(*) AS deliveries FROM public.delivery d GROUP BY d.courier_id HAVING COUNT(*) >= 30 ORDER BY deliveries DESC, d.courier_id ASC LIMIT 1;"}
{"query_id": "C2", "db_id": "t2sql", "nl_query": "Which courier has the fastest average delivery time?", "gold_sql": "SELECT d.courier_id, AVG(EXTRACT(EPOCH FROM (d.timestamp_utc - d.accept_ts_utc)) / 3600.0) AS avg_hours FROM public.delivery d WHERE d.timestamp_utc >= d.accept_ts_utc GROUP BY d.courier_id HAVING COUNT(*) >= 30 ORDER BY avg_hours ASC, d.courier_id ASC LIMIT 1;"}
{"query_id": "C3", "db_id": "t2sql", "nl_query": "On average, how many deliveries per day does each courier complete?", "gold_sql": "SELECT s.courier_id, AVG(cnt)::float AS avg_deliveries_per_day FROM ( SELECT d.courier_id, DATE_TRUNC('day', d.timestamp_utc) AS day, COUNT(*) AS cnt FROM public.delivery d GROUP BY d.courier_id, day ) s GROUP BY s.courier_id ORDER BY avg_deliveries_per_day DESC, s.courier_id ASC;"}
{"query_id": "C4", "db_id": "t2sql", "nl_query": "What is the maximum number of deliveries in one day by a single courier?", "gold_sql": "SELECT courier_id, day::date AS date, cnt FROM ( SELECT d.courier_id, DATE_TRUNC('day', d.timestamp_utc) AS day, COUNT(*) AS cnt FROM public.delivery d GROUP BY d.courier_id, day ) s ORDER BY cnt DESC, courier_id ASC, day ASC LIMIT 1;"}
{"query_id": "C5", "db_id": "t2sql", "nl_query": "Which delivery courier has the shortest average cycle time?", "gold_sql": "SELECT d.courier_id, AVG(EXTRACT(EPOCH FROM (d.timestamp_utc - p.timestamp_utc)) / 3600.0) AS avg_cycle_hours FROM public.delivery d JOIN public.pickup p ON d.order_id = p.order_id WHERE d.timestamp_utc >= d.accept_ts_utc AND d.timestamp_utc >= p.timestamp_utc GROUP BY d.courier_id HAVING COUNT(*) >= 30 ORDER BY avg_cycle_hours ASC, d.courier_id ASC LIMIT 1;"}
{"query_id": "D1", "db_id": "t2sql", "nl_query": "How many orders have a pickup event but no delivery event?", "gold_sql": "SELECT COUNT(*) AS pickup_only_orders FROM public.pickup p LEFT JOIN public.delivery d ON d.order_id = p.order_id WHERE d.order_id IS NULL;"}
{"query_id": "D2", "db_id": "t2sql", "nl_query": "Which region has the highest share of pickup-only orders?", "gold_sql": "WITH totals AS ( SELECT p.region_id, COUNT(*) AS total_pickups FROM public.pickup p GROUP BY p.region_id ), po AS ( SELECT p.region_id, COUNT(*) AS pickup_only FROM public.pickup p LEFT JOIN public.delivery d ON d.order_id = p.order_id WHERE d.order_id IS NULL GROUP BY p.region_id ) SELECT t.region_id, COALESCE(po.pickup_only, 0)::float / NULLIF(t.total_pickups, 0) AS pickup_only_share FROM totals t LEFT JOIN po ON po.region_id = t.region_id ORDER BY pickup_only_share DESC NULLS LAST, t.region_id ASC LIMIT 1;"}
{"query_id": "D3", "db_id": "t2sql", "nl_query": "Which pickup courier has the most pickup-only orders?", "gold_sql": "SELECT p.courier_id, COUNT(*) AS pickup_only_orders FROM public.pickup p LEFT JOIN public.delivery d ON d.order_id = p.order_id WHERE d.order_id IS NULL GROUP BY p.courier_id ORDER BY pickup_only_orders DESC, p.courier_id ASC LIMIT 1;"}
{"query_id": "D4", "db_id": "t2sql", "nl_query": "How many events violate chronology rules?", "gold_sql": "WITH del_bad AS ( SELECT d.order_id FROM public.delivery d WHERE d.timestamp_utc >= d.accept_ts_utc ), cycle_bad AS ( SELECT d.order_id FROM public.delivery d JOIN public.pickup p ON p.order_id = d.order_id WHERE d.timestamp_utc >= d.accept_ts_utc AND d.timestamp_utc < p.timestamp_utc ) SELECT COUNT(DISTINCT order_id) AS chronology_violations FROM ( SELECT order_id FROM del_bad UNION SELECT order_id FROM cycle_bad ) u;"}
{"query_id": "D5", "db_id": "t2sql", "nl_query": "How many packages were reported as damaged?", "gold_sql": null}
{"query_id": "E1", "db_id": "t2sql", "nl_query": "Which city handled the highest volume of deliveries?", "gold_sql": "SELECT d.city, COUNT(*) AS deliveries FROM public.delivery d GROUP BY d.city HAVING COUNT(*) >= 30 ORDER BY deliveries DESC, d.city ASC LIMIT 1;"}
{"query_id": "E2", "db_id": "t2sql", "nl_query": "What percentage of deliveries were made in each AOI type?", "gold_sql": "SELECT d.aoi_type, 100.0 * COUNT(*) / SUM(COUNT(*)) OVER () AS percentage FROM public.delivery d GROUP BY d.aoi_type ORDER BY percentage DESC, d.aoi_type ASC;"}
{"query_id": "E3", "db_id": "t2sql", "nl_query": "In which city do deliveries take the longest on average?", "gold_sql": "SELECT d.city, AVG(EXTRACT(EPOCH FROM (d.timestamp_utc - d.accept_ts_utc)) / 3600.0) AS avg_hours FROM public.delivery d WHERE d.timestamp_utc >= d.accept_ts_utc GROUP BY d.city HAVING COUNT(*) >= 30 ORDER BY avg_hours DESC, d.city ASC LIMIT 1;"}
{"query_id": "E4", "db_id": "t2sql", "nl_query": "Which region_id recorded the highest number of deliveries?", "gold_sql": "SELECT d.region_id, COUNT(*) AS deliveries FROM public.delivery d GROUP BY d.region_id ORDER BY deliveries DESC, d.region_id ASC LIMIT 1;"}
{"query_id": "E5", "db_id": "t2sql", "nl_query": "Which city has the highest pickup volume?", "gold_sql": "SELECT p.city, COUNT(*) AS pickups FROM public.pickup p GROUP BY p.city ORDER BY pickups DESC, p.city ASC LIMIT 1;"}
{"query_id": "F1", "db_id": "t2sql", "nl_query": "How many deliveries were completed by courier 2382?", "gold_sql": "SELECT COUNT(*) AS deliveries_by_2382 FROM public.delivery d WHERE d.courier_id = 2382;"}
{"query_id": "F2", "db_id": "t2sql", "nl_query": "For order 2115566, what was the time between pickup and delivery?", "gold_sql": "SELECT EXTRACT(EPOCH FROM (d.timestamp_utc - p.timestamp_utc)) / 3600.0 AS hours FROM public.delivery d JOIN public.pickup p ON d.order_id = p.order_id WHERE d.order_id = 2115566 AND d.timestamp_utc >= p.timestamp_utc LIMIT 1;"}
{"query_id": "F3", "db_id": "t2sql", "nl_query": "How many pickups occurred in AOI ID 50?", "gold_sql": "SELECT COUNT(*) AS pickups_in_aoi_50 FROM public.pickup p WHERE p.aoi_id = 50;"}
{"query_id": "F4", "db_id": "t2sql", "nl_query": "How many deliveries occurred in region 10?", "gold_sql": "SELECT COUNT(*) AS deliveries_in_region_10 FROM public.delivery d WHERE d.region_id = 10;"}
{"query_id": "F5", "db_id": "t2sql", "nl_query": "At what time was the delivery for order 2031782 completed?", "gold_sql": "SELECT d.timestamp_utc AS delivery_completion_time FROM public.delivery d WHERE d.order_id = 2031782 ORDER BY d.timestamp_utc ASC, d.order_id ASCLIMIT 1;"}
